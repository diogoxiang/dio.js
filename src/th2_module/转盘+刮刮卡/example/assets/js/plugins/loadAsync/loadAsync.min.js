!function(root){"use strict";var count=0,total=0,xhr=new XMLHttpRequest,fragment=document.createDocumentFragment(),jsCount=0,jsTotal=0,config=null,nodes=[],loadAsycn=function(t,o,n){"string"==typeof t&&"json"===_getType(t)?loadConfig(t,function(t){var e=t.paths,a=e.length;0===a&&_call(o,1,1),_loadHandler(_getType(t.paths[count]),t.paths[count],t.paths,o,n)},function(){throw"Load config file failed!"}):isArray(t)&&(_setInt(t),_loadHandler(_getType(t[count]),t[count],t,o,n))},_getType=function(t){var o=/(.(png|jpg|jpeg|gif|bmp|svg){1})$/gi.test(t)?"image":/(.(mp3|wav){1})$/gi.test(t)?"audio":/(.(ogg|mp4|wma){1})$/gi.test(t)?"video":/(.js){1}$/gi.test(t)?"script":/(.json){1}$/gi.test(t)?"json":null;return o},_loadHandler=function(t,o,n,e,a){if(t){if("script"===t)return void _loadJsHandler(t,o,n,e,a);var c=new(window[function(){var o=t,n=t.substr(0,1).toUpperCase()+o.substring(1);return n}()]);c.onload=c.oncomplete=c.onreadystatechange=function(t){return c.onload=c.oncomplete=c.onreadystatechange=null,count++,_call(e,c,count,total),count>=total?void(count=0):void _loadHandler(_getType(n[count]),n[count],n,e,a)},c.onerror=function(t){return c.onerror=null,count++,_call(a,c,count,total),count>=total?(_call(e,c,count,total),void(count=0)):void _loadHandler(_getType(n[count]),n[count],n,e,a)},c.src=o}},_loadJsHandler=function(t,o,n,e,a){var c=document.createElement("script");c.onload=c.oncomplete=c.onreadystatechange=function(t){return c.onload=c.oncomplete=c.onreadystatechange=null,count++,_call(e,c,count,total),count>=total?void(count=0):void _loadHandler(_getType(n[count]),n[count],n,e,a)},c.onerror=function(t){return c.onerror=null,console.log("load script: "+o+" failed!"),count++,_call(a,c,count,total),count>=total?(_call(e,c,count,total),void(count=0)):void _loadHandler(_getType(n[count]),n[count],n,e,a)},c.charset="utf-8",c.async=!0,c.src=o,fragment.appendChild(c),document.querySelector("head").appendChild(fragment)},loadConfig=function(t,o,n){xhr.open("GET",t,!1),xhr.onreadystatechange=function(t){4===this.readyState&&200===this.status?(xhr.onreadystatechange=null,config=_formateConfig(xhr.responseText),_call(o,xhr,config)):_call(n,xhr)},xhr.send()},loadScript=function(t,o,n){_setInt(t),_loadHandler("script",t[count],t,o,n)},loadImage=function(t,o,n){_setInt(t),_loadHandler("image",t[count],t,o,n)},loadAudio=function(t,o,n){_setInt(t),_loadHandler("audio",t[count],t,o,n)},loadVideo=function(t,o,n){_setInt(t),_loadHandler("video",t[count],t,o,n)},_setInt=function(t){total=t.length},_replaceScript=function(text){var txt=text.replace(/(\n|\t|\r)*/gi,"").replace(/\/\\*[\S\s\*]*\\*\//gi,"");console.log(txt),eval(txt)},_call=function(t,o){for(var n=[],e=2;e<arguments.length;++e)n.push(arguments[e]);"function"==typeof t&&t.apply(o,n)},isArray=function(t){return"[object Array]"===toString.call(t)},_formateConfig=function(t){var o=t;try{o=JSON.parse(t)}catch(n){}return t},LoadAsync=function(){this.loadConfig=loadConfig,this.loadAsync=loadAsycn,this.loadScript=loadScript,this.loadImage=loadImage,this.loadAudio=loadAudio,this.loadVideo=loadVideo};"function"==typeof define?define(function(){return LoadAsync}):"object"==typeof exports&&(module.exports=LoadAsync),root.LoadAsync=LoadAsync}(window);